{
  "version": 2,
  "endpoints": [
    {
      "endpoint": "/token",
      "method": "POST",
      "querystring_params": [ "username", "password", "client_id", "grant_type", "client_secret", "scope" ],
      "extra_config": {
        "github.com/devopsfaith/krakend-jose/signer": {
          "alg": "HS256",
          "kid": "sim2",
          "keys-to-sign": [ "access_token", "refresh_token" ],
          "jwk-url": "http://keycloak:8080/auth/realms/myrealm/protocol/openid-connect/certs",
          "disable_jwk_security": true
        }
      },
      "backend": [
        {
          "host": [ "http://keycloak:8080" ],
          "url_pattern": "/auth/realms/myrealm/protocol/openid-connect/token"
        }
      ]
    },
    {
      "endpoint": "/mockbin",
      "method": "GET",
      "querystring_params": [ "foo", "bar", "baz", "qux" ],
      "extra_config": {
        "github.com/devopsfaith/krakend-jose/validator": {
          "alg": "RS256",
          "jwk-url": "http://keycloak:8080/auth/realms/myrealm/protocol/openid-connect/certs",
          "issuer": "http://keycloak:8080/auth/realms/myrealm",
          "disable_jwk_security": true
        }
      },
      "backend": [
        {
          "host": [ "https://mockbin.org" ],
          "url_pattern": "/request"
        }
      ]
    },
    {
      "endpoint": "/produce",
      "method": "POST",
      "backend": [
        {
          "host": [ "amqp://guest:guest@rabbitmq:5672" ],
          "disable_host_sanitize": true,
          "extra_config": {
            "github.com/devopsfaith/krakend-amqp/produce": {
              "name": "queue-1",
              "exchange": "some-exchange",
              "durable": true,
              "delete": false,
              "exclusive": false,
              "no_wait": true,
              "mandatory": true,
              "immediate": false
            }
          }
        }
      ]
    },
    {
      "endpoint": "/consume",
      "method": "GET",
      "backend": [
        {
          "host": [ "amqp://guest:guest@rabbitmq:5672" ],
          "disable_host_sanitize": true,
          "extra_config": {
            "github.com/devopsfaith/krakend-amqp/consume": {
              "name": "queue-1",
              "exchange": "some-exchange",
              "durable": true,
              "delete": false,
              "exclusive": false,
              "no_wait": true,
              "no_local": false,
              "routing_key": [
                 "#"
              ],
              "prefetch_count": 10
            }
          }
        }
      ]
    }
  ],
  "extra_config": {
    "github_com/devopsfaith/krakend-opencensus": {
      "exporters": {
        "prometheus": {
          "port": "9090",
          "namespace": "krakend"
        }
      }
    }
  }
}
